// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package zia

import (
	"context"
	"reflect"

	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
	"github.com/zscaler/pulumi-zia/sdk/go/zia/internal"
)

// * [Official documentation](https://help.zscaler.com/zia/adding-rules-cloud-app-control-policy)
// * [API documentation](https://help.zscaler.com/zia/cloud-app-control-policy#/webApplicationRules/)
//
// Use the **zia_cloud_app_control_rule_actions** data source to retrieve the available actions for specific cloud applications and rule types. This data source automatically handles action intersections when multiple applications are specified, returning only actions supported by ALL applications.
//
// **NOTE**: Note that some new actions may not be returned in the API response. This is a known issue, and is being investigated via the following issue `ONEAPI-2421`. Please contact Zscaler support for an update if the action you're attempting ton configure isn't supported or returned in the response.
//
// The data source provides multiple output attributes for different use cases:
//
// * **`availableActionsWithoutIsolate`** - Most common use case for standard rules
// * **`isolateActions`** - For Cloud Browser Isolation (CBI) rules
// * **`filteredActions`** - Custom filtering by action type (ALLOW, DENY, etc.)
// * **`availableActions`** - Complete list of all actions
//
// ## Example Usage
//
// ### Standard Rule (Most Common)
//
// Use `availableActionsWithoutIsolate` for standard rules that don't require Cloud Browser Isolation:
//
// ### Isolation Rule (CBI)
//
// Use `isolateActions` for Cloud Browser Isolation rules:
//
// ### Multiple Applications (Intersection)
//
// When multiple applications are specified, the API automatically returns only actions supported by ALL applications:
//
// ### Filter By Action Type (ALLOW Only)
//
// Use `actionPrefixes` to filter actions by type:
//
// ### Filter Multiple Action Types
//
// Filter for multiple action types simultaneously:
//
// ### File Sharing Applications
//
// ### Only DENY Actions
//
// ## Understanding Action Types
//
// ### Action Prefixes
//
// Cloud App Control rules support different action types based on the application and rule type:
//
// | Prefix | Description | Example | Can Mix With |
// |--------|-------------|---------|--------------|
// | `ALLOW` | Permit specific operations | ALLOW_AI_ML_CHAT | DENY, CAUTION, ESC |
// | `DENY` | Block specific operations | DENY_AI_ML_UPLOAD | ALLOW, CAUTION, ESC |
// | `BLOCK` | Block operations (some apps) | BLOCK_FILE_SHARE_DOWNLOAD | ALLOW, CAUTION |
// | `CAUTION` | Warn before allowing | CAUTION_AI_ML_WEB_USE | ALLOW, DENY, BLOCK |
// | `ISOLATE` | Cloud Browser Isolation | ISOLATE_AI_ML_WEB_USE | **Cannot mix** |
// | `ESC` | Conditional access | AI_ML_CONDITIONAL_ACCESS | ALLOW, DENY |
//
// ### Important Rules
//
// 1. **ISOLATE Actions**:
//   - Cannot be mixed with any other action type
//   - Require `cbiProfile` configuration in the resource
//   - Use `isolateActions` attribute or filter with `actionPrefixes = ["ISOLATE"]`
//
// 2. **Multiple Applications**:
//   - The API automatically returns the intersection of actions
//   - Only actions supported by ALL specified applications are returned
//   - Always query the data source with the same applications you'll use in the resource
//
// 3. **Action Compatibility**:
//   - Most actions can be mixed (ALLOW + DENY, ALLOW + CAUTION, etc.)
//   - ISOLATE actions are the exception - they must be used alone
//
// ## Best Practices
//
// ### 1. Use Data Source Instead of Hardcoding
//
// **❌ Avoid hardcoding actions**:
//
// **✅ Use data source**:
//
// ### 2. Match Applications Between Data Source and Resource
//
// **❌ Mismatch (will cause validation errors)**:
//
// **✅ Correct match**:
//
// ### 3. Choose the Right Output Attribute
//
// | Use Case | Attribute to Use | Example |
// |----------|------------------|---------|
// | Standard rule (no CBI) | `availableActionsWithoutIsolate` | Most common |
// | CBI/Isolation rule | `isolateActions` | Requires cbiProfile |
// | Only permissive actions | `filteredActions` with `actionPrefixes = ["ALLOW"]` | Allow-only policy |
// | Only restrictive actions | `filteredActions` with `actionPrefixes = ["DENY"]` | Deny-only policy |
// | Mixed ALLOW/DENY | `filteredActions` with `actionPrefixes = ["ALLOW", "DENY"]` | Fine-grained control |
// | Full list for custom logic | `availableActions` | Manual filtering |
//
// ## Complete Examples
//
// ### Example 1: Standard Rule with Multiple Action Types
//
// ### Example 2: Permissive Rule (ALLOW Only)
//
// ### Example 3: Restrictive Rule (DENY Only)
//
// ### Example 4: Multiple Applications with Intersection
//
// ### Example 5: CAUTION Actions Only
//
// ### Example 6: Viewing All Available Attributes
//
// ## Notes
//
// ### Application Intersection Behavior
//
// When querying multiple applications, the API returns only the intersection of actions:
//
// **Example**:
//
// * `CHATGPT_AI` alone supports 12 actions (including ALLOW_AI_ML_RENAME)
// * `GOOGLE_GEMINI` alone supports 11 actions (does NOT support RENAME)
// * Query with both: `["CHATGPT_AI", "GOOGLE_GEMINI"]` returns 9 actions (RENAME excluded)
//
// This ensures that rules with multiple applications only use actions that work for all of them.
//
// ### ISOLATE Actions Special Requirements
//
// ISOLATE actions have unique requirements:
//
// 1. **Cannot be mixed**: ISOLATE actions must be used alone in a rule
// 2. **Require CBI profile**: Must configure `cbiProfile` block with a valid profile
// 3. **No EUN template**: Cannot set `browserEunTemplateId` when using ISOLATE
// 4. **Separate rules**: Create one rule for ISOLATE actions, separate rules for other actions
//
// ### Validation
//
// The `CloudAppControlRule` resource automatically validates actions during `pulumi preview`:
//
// * Ensures actions are valid for the specified applications
// * Validates ISOLATE action requirements
// * Provides helpful error messages with valid action lists
// * Suggests using the data source if manual actions are invalid
func GetCloudAppControlRuleActions(ctx *pulumi.Context, args *GetCloudAppControlRuleActionsArgs, opts ...pulumi.InvokeOption) (*GetCloudAppControlRuleActionsResult, error) {
	opts = internal.PkgInvokeDefaultOpts(opts)
	var rv GetCloudAppControlRuleActionsResult
	err := ctx.Invoke("zia:index/getCloudAppControlRuleActions:getCloudAppControlRuleActions", args, &rv, opts...)
	if err != nil {
		return nil, err
	}
	return &rv, nil
}

// A collection of arguments for invoking getCloudAppControlRuleActions.
type GetCloudAppControlRuleActionsArgs struct {
	ActionPrefixes []string `pulumi:"actionPrefixes"`
	CloudApps      []string `pulumi:"cloudApps"`
	Type           string   `pulumi:"type"`
}

// A collection of values returned by getCloudAppControlRuleActions.
type GetCloudAppControlRuleActionsResult struct {
	ActionPrefixes []string `pulumi:"actionPrefixes"`
	// (List of Strings) Complete list of all available actions for the specified cloud applications and rule type, including ISOLATE actions. Use when you need the full list or want to apply custom Terraform filtering logic.
	AvailableActions []string `pulumi:"availableActions"`
	// (List of Strings) **Recommended for most use cases**. List of available actions excluding ISOLATE actions. Use this for standard Cloud App Control rules. ISOLATE actions cannot be mixed with other action types and require separate rules.
	AvailableActionsWithoutIsolates []string `pulumi:"availableActionsWithoutIsolates"`
	CloudApps                       []string `pulumi:"cloudApps"`
	// (List of Strings) List of actions filtered by the `actionPrefixes` parameter. Only populated when `actionPrefixes` is specified. Use this for custom filtering by specific action types (ALLOW only, DENY only, ALLOW+DENY, etc.).
	FilteredActions []string `pulumi:"filteredActions"`
	// The provider-assigned unique ID for this managed resource.
	Id string `pulumi:"id"`
	// (List of Strings) List of only ISOLATE actions (Cloud Browser Isolation). Use this for CBI rules. When using ISOLATE actions:
	// * They **cannot** be mixed with other action types (ALLOW, DENY, etc.)
	// * They **require** `cbiProfile` block in the resource
	// * They **cannot** have `browserEunTemplateId` set
	// * Create separate rules for ISOLATE vs non-ISOLATE actions
	IsolateActions []string `pulumi:"isolateActions"`
	Type           string   `pulumi:"type"`
}

func GetCloudAppControlRuleActionsOutput(ctx *pulumi.Context, args GetCloudAppControlRuleActionsOutputArgs, opts ...pulumi.InvokeOption) GetCloudAppControlRuleActionsResultOutput {
	return pulumi.ToOutputWithContext(ctx.Context(), args).
		ApplyT(func(v interface{}) (GetCloudAppControlRuleActionsResultOutput, error) {
			args := v.(GetCloudAppControlRuleActionsArgs)
			options := pulumi.InvokeOutputOptions{InvokeOptions: internal.PkgInvokeDefaultOpts(opts)}
			return ctx.InvokeOutput("zia:index/getCloudAppControlRuleActions:getCloudAppControlRuleActions", args, GetCloudAppControlRuleActionsResultOutput{}, options).(GetCloudAppControlRuleActionsResultOutput), nil
		}).(GetCloudAppControlRuleActionsResultOutput)
}

// A collection of arguments for invoking getCloudAppControlRuleActions.
type GetCloudAppControlRuleActionsOutputArgs struct {
	ActionPrefixes pulumi.StringArrayInput `pulumi:"actionPrefixes"`
	CloudApps      pulumi.StringArrayInput `pulumi:"cloudApps"`
	Type           pulumi.StringInput      `pulumi:"type"`
}

func (GetCloudAppControlRuleActionsOutputArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*GetCloudAppControlRuleActionsArgs)(nil)).Elem()
}

// A collection of values returned by getCloudAppControlRuleActions.
type GetCloudAppControlRuleActionsResultOutput struct{ *pulumi.OutputState }

func (GetCloudAppControlRuleActionsResultOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*GetCloudAppControlRuleActionsResult)(nil)).Elem()
}

func (o GetCloudAppControlRuleActionsResultOutput) ToGetCloudAppControlRuleActionsResultOutput() GetCloudAppControlRuleActionsResultOutput {
	return o
}

func (o GetCloudAppControlRuleActionsResultOutput) ToGetCloudAppControlRuleActionsResultOutputWithContext(ctx context.Context) GetCloudAppControlRuleActionsResultOutput {
	return o
}

func (o GetCloudAppControlRuleActionsResultOutput) ActionPrefixes() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.ActionPrefixes }).(pulumi.StringArrayOutput)
}

// (List of Strings) Complete list of all available actions for the specified cloud applications and rule type, including ISOLATE actions. Use when you need the full list or want to apply custom Terraform filtering logic.
func (o GetCloudAppControlRuleActionsResultOutput) AvailableActions() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.AvailableActions }).(pulumi.StringArrayOutput)
}

// (List of Strings) **Recommended for most use cases**. List of available actions excluding ISOLATE actions. Use this for standard Cloud App Control rules. ISOLATE actions cannot be mixed with other action types and require separate rules.
func (o GetCloudAppControlRuleActionsResultOutput) AvailableActionsWithoutIsolates() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.AvailableActionsWithoutIsolates }).(pulumi.StringArrayOutput)
}

func (o GetCloudAppControlRuleActionsResultOutput) CloudApps() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.CloudApps }).(pulumi.StringArrayOutput)
}

// (List of Strings) List of actions filtered by the `actionPrefixes` parameter. Only populated when `actionPrefixes` is specified. Use this for custom filtering by specific action types (ALLOW only, DENY only, ALLOW+DENY, etc.).
func (o GetCloudAppControlRuleActionsResultOutput) FilteredActions() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.FilteredActions }).(pulumi.StringArrayOutput)
}

// The provider-assigned unique ID for this managed resource.
func (o GetCloudAppControlRuleActionsResultOutput) Id() pulumi.StringOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) string { return v.Id }).(pulumi.StringOutput)
}

// (List of Strings) List of only ISOLATE actions (Cloud Browser Isolation). Use this for CBI rules. When using ISOLATE actions:
// * They **cannot** be mixed with other action types (ALLOW, DENY, etc.)
// * They **require** `cbiProfile` block in the resource
// * They **cannot** have `browserEunTemplateId` set
// * Create separate rules for ISOLATE vs non-ISOLATE actions
func (o GetCloudAppControlRuleActionsResultOutput) IsolateActions() pulumi.StringArrayOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) []string { return v.IsolateActions }).(pulumi.StringArrayOutput)
}

func (o GetCloudAppControlRuleActionsResultOutput) Type() pulumi.StringOutput {
	return o.ApplyT(func(v GetCloudAppControlRuleActionsResult) string { return v.Type }).(pulumi.StringOutput)
}

func init() {
	pulumi.RegisterOutputType(GetCloudAppControlRuleActionsResultOutput{})
}
